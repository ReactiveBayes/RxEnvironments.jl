<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Windy Gridworld · RxEnvironments.jl</title><meta name="title" content="Windy Gridworld · RxEnvironments.jl"/><meta property="og:title" content="Windy Gridworld · RxEnvironments.jl"/><meta property="twitter:title" content="Windy Gridworld · RxEnvironments.jl"/><meta name="description" content="Documentation for RxEnvironments.jl."/><meta property="og:description" content="Documentation for RxEnvironments.jl."/><meta property="twitter:description" content="Documentation for RxEnvironments.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RxEnvironments.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example_mountaincar/">Mountain Car</a></li><li class="is-active"><a class="tocitem" href>Windy Gridworld</a></li></ul></li><li><a class="tocitem" href="../advanced_usage/">Advanced Usage</a></li><li><a class="tocitem" href="../philosophy/">Design Philosophy</a></li><li><a class="tocitem" href="../api_reference/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Windy Gridworld</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Windy Gridworld</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/biaslab/RxEnvironments.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/biaslab/RxEnvironments.jl/blob/main/docs/src/lib/example_discrete_control_space_env.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-Discrete-control-space-environment"><a class="docs-heading-anchor" href="#Example:-Discrete-control-space-environment">Example: Discrete control space environment</a><a id="Example:-Discrete-control-space-environment-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Discrete-control-space-environment" title="Permalink"></a></h1><p>RxEnvironments can handle discrete state- and control spaces. In this example, we will create a simple discrete control space environment: The windy gridworld. The agent is placed on a grid and can move up, down, left, or right. However, there is a crosswind that pushes the agent up on the grid. The goal is to reach the goal state. First, we create the environment and the agent type. The agent type is mutable, as the agent&#39;s position will change over time.</p><pre><code class="language-julia hljs">using RxEnvironments

struct WindyGridWorld{N}
    wind::NTuple{N, Int}
    agents::Vector
    goal::Tuple{Int, Int}
end

mutable struct WindyGridWorldAgent
    position::Tuple{Int, Int}
end</code></pre><p>Next, we implement the <code>RxEnvironments</code> specific functions. In this environment, the environment state can only change when it is prompted with an action by an agent, so we do not need to implement anything for the <code>update!</code> function. For the <code>receive!</code> function, which changes the internal state of the environment (the position of the agent) we check if the action is valid and update the agent&#39;s position accordingly. The <code>what_to_send</code> function is triggered when the environment wants to send an observation to the agent, and we will send the agent&#39;s position.</p><pre><code class="language-julia hljs">RxEnvironments.update!(env::WindyGridWorld, dt) = nothing # The environment has no &quot;internal&quot; updating process over time

function RxEnvironments.receive!(env::WindyGridWorld{N}, agent::WindyGridWorldAgent, action::Tuple{Int, Int}) where {N}
    @show action
    if action[1] != 0
        @assert action[2] == 0 &quot;Only one of the two actions can be non-zero&quot;
    elseif action[2] != 0
        @assert action[1] == 0 &quot;Only one of the two actions can be non-zero&quot;
    end
    new_position = (agent.position[1] + action[1], agent.position[2] + action[2] + env.wind[agent.position[1]])
    if all(elem -&gt; 0 &lt; elem &lt; N, new_position)
        agent.position = new_position
    else
        @info &quot;Agent moved outside the grid; position is not updated.&quot;
    end
end

function RxEnvironments.what_to_send(env::WindyGridWorld, agent::WindyGridWorldAgent)
    return agent.position
end</code></pre><p>In order to prepare the visualization of the environment, we implement the <code>RxEnvironments</code> specific functions <code>add_to_state!</code> and <code>plot_state</code>. The <code>add_to_state!</code> function is used to add an agent to the internal state of the environment, such that we have access in the <code>plot_state</code> function. The <code>plot_state</code> function is used to visualize the environment state. In this case, we plot the agent&#39;s position in red and the goal position in blue.</p><pre><code class="language-julia hljs">function RxEnvironments.add_to_state!(env::WindyGridWorld, agent::WindyGridWorldAgent)
    push!(env.agents, agent)
end

function RxEnvironments.plot_state(ax, env::WindyGridWorld{N}) where {N}
    xlims!(ax, (0, N))
    ylims!(ax, (0, N))
    for agent in env.agents
        scatter!(ax, agent.position[1], agent.position[2], color=&quot;red&quot;)
    end
    scatter!(ax, env.goal[1], env.goal[2], color=&quot;blue&quot;)
end</code></pre><p>Now, we can create the environment and the agent and visualize the environment. We create a 10x10 grid with a goal at position (8, 5) and a crosswind that pushes the agent up by 1, and 2 around the goal. We place the agent at position (1, 1) and visualize the environment.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It should be noted that, even though we have a discrete space environment with discrete timesteps, we don&#39;t use the <code>discrete=true</code> keyword argument in the <code>RxEnvironment</code> function. In this setting, because the environment only changes when an agent emits an action and has no time-dependent dynamics, the environment is effectively discrete and there is no difference. However, if we have multiple agents, the environment without the <code>discrete=true</code> keyword argument will update the state whenever any agent emits an action, whereas the environment with the <code>discrete=true</code> keyword argument will only update the state when all agents have emitted an action.</p></div></div><pre><code class="language-julia hljs">env = RxEnvironment(WindyGridWorld((0, 0, 0, 1, 1, 1, 2, 2, 1, 0), [], (8, 5)))
agent = add!(env, WindyGridWorldAgent((1, 1)))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Continuous RxEntity{Main.WindyGridWorldAgent}</code></pre><pre><code class="language- hljs">RxEnvironments.animate_state(env)</code></pre><p><img src="../../img/animate_discrete.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example_mountaincar/">« Mountain Car</a><a class="docs-footer-nextpage" href="../advanced_usage/">Advanced Usage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 17 May 2024 13:19">Friday 17 May 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
